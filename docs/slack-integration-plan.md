# Slackçµ±åˆè¨ˆç”»

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€mugu-orchestrationã‚’Slackãƒœãƒƒãƒˆã¨ã—ã¦çµ±åˆã™ã‚‹éš›ã®æ§‹æƒ³ã¨å®Ÿè£…ãƒ—ãƒ©ãƒ³ã‚’ã¾ã¨ã‚ãŸã‚‚ã®ã§ã™ã€‚

## ç›®æ¬¡

1. [å…¨ä½“æ§‹æƒ³](#å…¨ä½“æ§‹æƒ³)
2. [ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
3. [æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯](#æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯)
4. [æ–™é‡‘ä½“ç³»ã®ç†è§£](#æ–™é‡‘ä½“ç³»ã®ç†è§£)
5. [å®Ÿè£…ãƒ—ãƒ©ãƒ³](#å®Ÿè£…ãƒ—ãƒ©ãƒ³)
6. [ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼](#ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼)
7. [Notionçµ±åˆ](#notionçµ±åˆ)
8. [å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹çµ±åˆ](#å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹çµ±åˆ)
9. [ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …](#ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …)
10. [é‹ç”¨è¨ˆç”»](#é‹ç”¨è¨ˆç”»)

---

## å…¨ä½“æ§‹æƒ³

### ãƒ“ã‚¸ãƒ§ãƒ³

**Slackã‚’ãƒãƒ–ã€Notionã‚’æ°¸ç¶šDBã¨ã™ã‚‹å€‹äººç”¨ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ã‚¹ãƒ†ãƒ **

```
ã€æƒ…å ±æºï¼ˆåˆ†æ•£ï¼‰ã€‘
â”œâ”€ Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼
â”œâ”€ Gmail
â”œâ”€ LINE
â”œâ”€ ãƒ¬ã‚·ãƒ¼ãƒˆç”»åƒ
â”œâ”€ GitHubé€šçŸ¥
â”œâ”€ Vercelé€šçŸ¥
â””â”€ ãã®ä»–API

        â†“ å…¨ã¦Slackã«é›†ç´„

ã€Slackãƒãƒ–ï¼ˆSocket Modeï¼‰ã€‘
â”œâ”€ æœ8æ™‚ã®ãƒ–ãƒªãƒ¼ãƒ•ã‚£ãƒ³ã‚°
â”œâ”€ ã‚¿ã‚¹ã‚¯ç®¡ç†
â”œâ”€ çµŒè²»è¨˜éŒ²
â”œâ”€ å„ç¨®é€šçŸ¥ã®å—ä¿¡
â””â”€ 90æ—¥ã§æ¶ˆãˆã‚‹ï¼ˆæ®ç™ºæ€§ï¼‰

        â†“ é‡è¦ãªæƒ…å ±ã‚’è‡ªå‹•ä¿å­˜

ã€Notionï¼ˆæ°¸ç¶šDBï¼‰ã€‘
â”œâ”€ ã‚¿ã‚¹ã‚¯ç®¡ç†DB
â”œâ”€ ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆDB
â”œâ”€ çµŒè²»ç®¡ç†DB
â”œâ”€ ä¼šè­°ãƒ¡ãƒ¢DB
â”œâ”€ å­¦ç¿’ãƒ­ã‚°DB
â””â”€ å±¥æ­´ãƒ»åˆ†æç”¨ãƒ‡ãƒ¼ã‚¿
```

### ç›®çš„

1. **æƒ…å ±ã®ä¸€å…ƒåŒ–**: æ•£ã‚‰ã°ã£ãŸæƒ…å ±ã‚’Slackã«é›†ç´„
2. **è‡ªå‹•åŒ–**: æ‰‹å‹•ã‚¿ã‚¹ã‚¯ã®å‰Šæ¸›
3. **æ°¸ç¶šåŒ–**: Slackã®90æ—¥åˆ¶é™ã‚’å›é¿ã—ã€Notionã§æ°¸ä¹…ä¿å­˜
4. **ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œ**: ã‚¹ãƒãƒ›ã‹ã‚‰ã§ã‚‚å…¨æ©Ÿèƒ½ã«ã‚¢ã‚¯ã‚»ã‚¹

---

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³1: Socket Mode + ãƒ­ãƒ¼ã‚«ãƒ«Claude Codeï¼ˆæ¨å¥¨ï¼‰

**ç¾åœ¨ã®ã€ŒAIç¤¾å“¡ã€ã¨åŒã˜æ§‹æˆ**

```
Slackï¼ˆSocket Modeï¼‰
  â†• WebSocketå¸¸æ™‚æ¥ç¶š
ã‚ãªãŸã®PCï¼ˆNode.jsï¼‰
  â†“ ãƒ­ãƒ¼ã‚«ãƒ«ã§ã‚¹ã‚­ãƒ«å®Ÿè¡Œ
Claude Codeï¼ˆProãƒ—ãƒ©ãƒ³ã§ç„¡æ–™ï¼‰
  â†“
Notionï¼ˆæ°¸ç¶šDBï¼‰
  â†“
çµæœã‚’Slackã«è¿”å´
```

**ãƒ¡ãƒªãƒƒãƒˆ**:
- âœ… å¤–éƒ¨å…¬é–‹ä¸è¦ï¼ˆngrokä¸è¦ï¼‰
- âœ… Claude APIæ–™é‡‘ä¸è¦ï¼ˆProãƒ—ãƒ©ãƒ³ã ã‘ã§OKï¼‰
- âœ… ã‚ˆã‚Šå®‰å…¨ï¼ˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆå…¬é–‹ã—ãªã„ï¼‰
- âœ… æ—¢å­˜ã®ã€ŒAIç¤¾å“¡ã€ã¨åŒã˜æ§‹æˆã§çµ±åˆå¯èƒ½

**ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ**:
- âŒ PCã‚’å¸¸æ™‚èµ·å‹•ã™ã‚‹å¿…è¦ãŒã‚ã‚‹
- âŒ å¤–å‡ºä¸­ã«PCã‚’ã‚ªãƒ•ã«ã™ã‚‹ã¨ä½¿ãˆãªã„

**æ¨å¥¨ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹**: å€‹äººç”¨ã€PCã‚’å¸¸æ™‚èµ·å‹•ã§ãã‚‹ç’°å¢ƒ

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³2: Claude API + ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ‡ãƒ—ãƒ­ã‚¤

```
Slack
  â†“ Webhookã¾ãŸã¯Socket Mode
ã‚¯ãƒ©ã‚¦ãƒ‰ã‚µãƒ¼ãƒãƒ¼ï¼ˆCloud Run/Vercelï¼‰
  â†“
Claude APIï¼ˆå¾“é‡èª²é‡‘ï¼‰
  â†“
Notionï¼ˆæ°¸ç¶šDBï¼‰
  â†“
Slackã«è¿”å´
```

**ãƒ¡ãƒªãƒƒãƒˆ**:
- âœ… PCã®èµ·å‹•ä¸è¦
- âœ… ã©ã“ã‹ã‚‰ã§ã‚‚ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
- âœ… é«˜å¯ç”¨æ€§

**ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ**:
- âŒ Claude APIæ–™é‡‘ãŒç™ºç”Ÿï¼ˆæœˆ$5-15ç¨‹åº¦ï¼‰
- âŒ ã‚¤ãƒ³ãƒ•ãƒ©ç®¡ç†ãŒå¿…è¦

**æ¨å¥¨ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹**: ãƒãƒ¼ãƒ åˆ©ç”¨ã€å¸¸æ™‚ç¨¼åƒãŒå¿…è¦

---

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### å¿…é ˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

```javascript
{
  "dependencies": {
    "@slack/bolt": "^3.x",           // Slack Socket Mode
    "@notionhq/client": "^2.x",      // Notion API
    "googleapis": "^130.x",          // Google Calendar/Gmail
    "@line/bot-sdk": "^8.x",         // LINEé€£æº
    "node-cron": "^3.x",             // ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å®Ÿè¡Œ
    "@anthropic-ai/sdk": "^0.x"      // Claude APIï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
  }
}
```

### ç’°å¢ƒå¤‰æ•°

```bash
# Slack
SLACK_BOT_TOKEN=xoxb-...
SLACK_APP_TOKEN=xapp-...          # Socket Modeç”¨
SLACK_SIGNING_SECRET=...

# Notion
NOTION_API_KEY=...
NOTION_TASKS_DB_ID=...
NOTION_EXPENSES_DB_ID=...
NOTION_CALENDAR_DB_ID=...
NOTION_BRIEFINGS_DB_ID=...

# Google
GOOGLE_CLIENT_ID=...
GOOGLE_CLIENT_SECRET=...
GOOGLE_REDIRECT_URI=...

# LINE
LINE_CHANNEL_ACCESS_TOKEN=...
LINE_CHANNEL_SECRET=...

# Claudeï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
ANTHROPIC_API_KEY=sk-ant-...      # APIä½¿ã†å ´åˆã®ã¿

# Supabaseï¼ˆæ—¢å­˜ï¼‰
SUPABASE_URL=...
SUPABASE_SERVICE_ROLE_KEY=...
```

---

## æ–™é‡‘ä½“ç³»ã®ç†è§£

### é‡è¦ãªé•ã„: Claude Pro vs Claude API

| é …ç›® | Claude Pro | Claude API |
|------|-----------|------------|
| **å¥‘ç´„å½¢æ…‹** | æœˆé¡ã‚µãƒ–ã‚¹ã‚¯ | å¾“é‡èª²é‡‘ï¼ˆåˆ¥å¥‘ç´„ï¼‰ |
| **æ–™é‡‘** | $20/æœˆ ä½¿ã„æ”¾é¡Œ | ãƒˆãƒ¼ã‚¯ãƒ³æ•°ã§èª²é‡‘ |
| **APIã‚­ãƒ¼** | ä¸è¦ | `sk-ant-...` ãŒå¿…è¦ |
| **ä½¿ç”¨æ–¹æ³•** | claude.ai, Claude Code | ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‹ã‚‰å‘¼ã³å‡ºã— |
| **ç”¨é€”** | å€‹äººåˆ©ç”¨ | ã‚¢ãƒ—ãƒªé–‹ç™ºã€è‡ªå‹•åŒ– |
| **Proã«å«ã¾ã‚Œã‚‹ï¼Ÿ** | - | âŒ å®Œå…¨ã«åˆ¥å¥‘ç´„ |

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³1ï¼ˆSocket Mode + ãƒ­ãƒ¼ã‚«ãƒ«ï¼‰ã®æ–™é‡‘

| ã‚µãƒ¼ãƒ“ã‚¹ | æœˆé¡ |
|---------|------|
| Claude Pro | $20ï¼ˆæ—¢å­˜ï¼‰ |
| Slackï¼ˆSocket Modeï¼‰ | $0ï¼ˆç„¡æ–™ï¼‰ |
| Notion | $0ï¼ˆç„¡æ–™ãƒ—ãƒ©ãƒ³ï¼‰ |
| Google Calendar API | $0ï¼ˆç„¡æ–™æ ï¼‰ |
| LINE Messaging API | $0ï¼ˆç„¡æ–™æ ï¼‰ |
| ã‚µãƒ¼ãƒãƒ¼ | $0ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ï¼‰ |
| **åˆè¨ˆ** | **$20**ï¼ˆè¿½åŠ ã‚³ã‚¹ãƒˆãªã—ï¼‰ |

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³2ï¼ˆClaude APIï¼‰ã®æ–™é‡‘

| ã‚µãƒ¼ãƒ“ã‚¹ | æœˆé¡ |
|---------|------|
| Claude Pro | $20ï¼ˆæ—¢å­˜ï¼‰ |
| **Claude API** | **$5-15**ï¼ˆä½¿ç”¨é‡æ¬¡ç¬¬ï¼‰ |
| Slack | $0 |
| Notion | $0 |
| Cloud Run | $0ï¼ˆç„¡æ–™æ ï¼‰ |
| **åˆè¨ˆ** | **$25-35** |

**Claude API ã‚³ã‚¹ãƒˆä¾‹**ï¼ˆSonnet 4.5ï¼‰:
- ã‚¹ãƒ©ã‚¤ãƒ‰ç”Ÿæˆ1å›: ç´„$0.135ï¼ˆç´„20å††ï¼‰
- æœˆ30å›ç”Ÿæˆ: ç´„$4
- æœˆ90å›ç”Ÿæˆ: ç´„$12

---

## å®Ÿè£…ãƒ—ãƒ©ãƒ³

### Phase 1: åŸºç›¤æ§‹ç¯‰ï¼ˆ1-2æ—¥ï¼‰

**ç›®çš„**: Socket Mode Slackãƒœãƒƒãƒˆã®åŸºæœ¬ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

**ã‚¿ã‚¹ã‚¯**:
1. Slack Appã®ä½œæˆ
   - Socket Modeæœ‰åŠ¹åŒ–
   - App-Level Tokenå–å¾—ï¼ˆxapp-...ï¼‰
   - Bot Tokenå–å¾—ï¼ˆxoxb-...ï¼‰

2. Node.jsãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
   ```bash
   mkdir mugu-orchestration-slack
   cd mugu-orchestration-slack
   npm init -y
   npm install @slack/bolt dotenv
   ```

3. åŸºæœ¬çš„ãªSocket Modeæ¥ç¶š
   ```javascript
   const { App } = require('@slack/bolt');

   const app = new App({
     token: process.env.SLACK_BOT_TOKEN,
     socketMode: true,
     appToken: process.env.SLACK_APP_TOKEN
   });

   (async () => {
     await app.start();
     console.log('âš¡ï¸ Bolt app is running!');
   })();
   ```

4. å‹•ä½œç¢ºèª
   - `/ping` ã‚³ãƒãƒ³ãƒ‰ã§å¿œç­”ç¢ºèª

**å®Œäº†æ¡ä»¶**:
- [ ] Socket Modeæ¥ç¶šæˆåŠŸ
- [ ] Slackã‹ã‚‰ãƒœãƒƒãƒˆã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡å¯èƒ½
- [ ] ãƒœãƒƒãƒˆã‹ã‚‰ã®å¿œç­”å—ä¿¡å¯èƒ½

### Phase 2: Claude Codeã‚¹ã‚­ãƒ«çµ±åˆï¼ˆ2-3æ—¥ï¼‰

**ç›®çš„**: æ—¢å­˜ã®slideã‚¹ã‚­ãƒ«ã‚’Slackã‹ã‚‰å‘¼ã³å‡ºã›ã‚‹ã‚ˆã†ã«ã™ã‚‹

**ã‚¿ã‚¹ã‚¯**:
1. `/slide` ã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè£…
   ```javascript
   app.command('/slide', async ({ command, ack, respond }) => {
     await ack();
     // Claude Codeã®ã‚¹ã‚­ãƒ«ã‚’å®Ÿè¡Œ
     const slideContent = await executeClaudeSkill('slide', command.text);
     // Slackã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
     await uploadToSlack(slideContent);
   });
   ```

2. Claude Codeå®Ÿè¡Œé–¢æ•°
   ```javascript
   async function executeClaudeSkill(skillName, userRequest) {
     // skills/[skillName]/SKILL.md ã‚’èª­ã¿è¾¼ã¿
     // Claude Codeã§å®Ÿè¡Œ
     // çµæœã‚’è¿”å´
   }
   ```

3. ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½
   ```javascript
   async function uploadToSlack(content, channel) {
     await app.client.files.upload({
       channels: channel,
       content: content,
       filename: 'presentation.md',
       title: 'ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³è³‡æ–™'
     });
   }
   ```

**å®Œäº†æ¡ä»¶**:
- [ ] `/slide` ã‚³ãƒãƒ³ãƒ‰ã§ã‚¹ãƒ©ã‚¤ãƒ‰ç”ŸæˆæˆåŠŸ
- [ ] ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒSlackã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒé©åˆ‡

### Phase 3: Notionçµ±åˆï¼ˆ2-3æ—¥ï¼‰

**ç›®çš„**: Slackã®ãƒ‡ãƒ¼ã‚¿ã‚’æ°¸ç¶šåŒ–

**ã‚¿ã‚¹ã‚¯**:
1. Notion APIã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
   - Integrationä½œæˆ
   - API Keyå–å¾—
   - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä½œæˆï¼ˆã‚¿ã‚¹ã‚¯ã€ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã€çµŒè²»ãªã©ï¼‰

2. Notionä¿å­˜é–¢æ•°
   ```javascript
   async function saveToNotion(database, data) {
     await notion.pages.create({
       parent: { database_id: databases[database] },
       properties: data
     });
   }
   ```

3. Slackã‚¤ãƒ™ãƒ³ãƒˆã®è‡ªå‹•ä¿å­˜
   - ã‚¿ã‚¹ã‚¯ä½œæˆæ™‚ã«Notionä¿å­˜
   - çµŒè²»è¨˜éŒ²æ™‚ã«Notionä¿å­˜
   - ãƒ–ãƒªãƒ¼ãƒ•ã‚£ãƒ³ã‚°å±¥æ­´ã®ä¿å­˜

**å®Œäº†æ¡ä»¶**:
- [ ] Notionãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä½œæˆå®Œäº†
- [ ] Slackã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿ä¿å­˜æˆåŠŸ
- [ ] Notionã‹ã‚‰èª­ã¿å–ã‚ŠæˆåŠŸ

### Phase 4: ãƒ‡ã‚¤ãƒªãƒ¼ãƒ–ãƒªãƒ¼ãƒ•ã‚£ãƒ³ã‚°ï¼ˆ2-3æ—¥ï¼‰

**ç›®çš„**: æ¯æœ8æ™‚ã«è‡ªå‹•ã§ä»Šæ—¥ã®äºˆå®šãƒ»ã‚¿ã‚¹ã‚¯ã‚’é€šçŸ¥

**ã‚¿ã‚¹ã‚¯**:
1. Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ APIé€£æº
   - OAuthèªè¨¼
   - ä»Šæ—¥ã®ã‚¤ãƒ™ãƒ³ãƒˆå–å¾—

2. Notionã‚¿ã‚¹ã‚¯å–å¾—
   - ä»Šæ—¥æœŸé™ã®ã‚¿ã‚¹ã‚¯
   - æ˜¨æ—¥ã®ç©ã¿æ®‹ã—

3. cronè¨­å®š
   ```javascript
   cron.schedule('0 8 * * *', async () => {
     await sendDailyBriefing();
   });
   ```

4. Slackãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç”Ÿæˆ
   - ãƒªãƒƒãƒãªãƒ–ãƒ­ãƒƒã‚¯å½¢å¼
   - ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒœã‚¿ãƒ³

**å®Œäº†æ¡ä»¶**:
- [ ] æ¯æœ8æ™‚ã«è‡ªå‹•å®Ÿè¡Œ
- [ ] ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆè¡¨ç¤º
- [ ] Notionã‚¿ã‚¹ã‚¯è¡¨ç¤º
- [ ] è¦‹ã‚„ã™ã„ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ

### Phase 5: çµŒè²»ç®¡ç†ï¼ˆexpense-trackerï¼‰ï¼ˆ2-3æ—¥ï¼‰

**ç›®çš„**: ãƒ¬ã‚·ãƒ¼ãƒˆç”»åƒã‹ã‚‰çµŒè²»ã‚’è‡ªå‹•è¨˜éŒ²

**ã‚¿ã‚¹ã‚¯**:
1. ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ¤œçŸ¥
   ```javascript
   app.event('file_shared', async ({ event }) => {
     // ãƒ¬ã‚·ãƒ¼ãƒˆç”»åƒå‡¦ç†
   });
   ```

2. Claude APIã§OCRï¼ˆã¾ãŸã¯Google Vision APIï¼‰
   - åº—èˆ—åã€æ—¥ä»˜ã€é‡‘é¡æŠ½å‡º
   - ã‚«ãƒ†ã‚´ãƒªè‡ªå‹•åˆ†é¡

3. NotionçµŒè²»DBã«ä¿å­˜
   - è‡ªå‹•ã‚«ãƒ†ã‚´ãƒªåˆ†é¡
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç®¡ç†ï¼ˆæœªç¢ºå®š/ç¢ºå®šï¼‰

4. Slacké€šçŸ¥
   - è¨˜éŒ²å®Œäº†é€šçŸ¥
   - ç¢ºèªãƒ»ä¿®æ­£ãƒœã‚¿ãƒ³

**å®Œäº†æ¡ä»¶**:
- [ ] ãƒ¬ã‚·ãƒ¼ãƒˆç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã§è‡ªå‹•èªè­˜
- [ ] æ­£ç¢ºãªæƒ…å ±æŠ½å‡ºï¼ˆ80%ä»¥ä¸Šï¼‰
- [ ] Notionä¿å­˜æˆåŠŸ
- [ ] ä¿®æ­£æ©Ÿèƒ½å‹•ä½œ

### Phase 6: å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹çµ±åˆï¼ˆ3-5æ—¥ï¼‰

**ç›®çš„**: LINEã€Gmailã€GitHubãªã©ã‚’Slackã«é›†ç´„

**ã‚¿ã‚¹ã‚¯**:
1. LINE â†’ Slackè»¢é€
   - LINE Messaging API Webhook
   - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è»¢é€
   - åŒæ–¹å‘é€šä¿¡ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

2. Gmail â†’ Slackè»¢é€
   - Gmail API
   - é‡è¦ãƒ¡ãƒ¼ãƒ«ã®è‡ªå‹•é€šçŸ¥
   - 5åˆ†ã”ã¨ã®ãƒã‚§ãƒƒã‚¯

3. GitHub â†’ Slackè»¢é€
   - GitHub Webhook
   - PRã€Issueé€šçŸ¥
   - è‡ªåˆ†å®›ã¦ã®ã¿ãƒ•ã‚£ãƒ«ã‚¿

**å®Œäº†æ¡ä»¶**:
- [ ] LINEé€šçŸ¥ãŒSlackã«è¡¨ç¤º
- [ ] é‡è¦ãƒ¡ãƒ¼ãƒ«ãŒSlackã«é€šçŸ¥
- [ ] GitHubé€šçŸ¥ãŒSlackã«è¡¨ç¤º

---

## ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

### 1. ã‚¹ãƒ©ã‚¤ãƒ‰ç”Ÿæˆãƒ•ãƒ­ãƒ¼

```
ãƒ¦ãƒ¼ã‚¶ãƒ¼: /slide Next.js 15ã«ã¤ã„ã¦
  â†“
Slackï¼ˆSocket Modeï¼‰
  â†“
Node.jsã‚µãƒ¼ãƒãƒ¼
  â†“
Claude Codeï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ï¼‰
  â”œâ”€ skills/slide/SKILL.md èª­ã¿è¾¼ã¿
  â”œâ”€ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé¸æŠ
  â”œâ”€ ã‚¹ãƒ©ã‚¤ãƒ‰ç”Ÿæˆ
  â””â”€ Markdownãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›
  â†“
Slackã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
  â†“
Notionã«å±¥æ­´ä¿å­˜ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
  â†“
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ãƒ•ã‚¡ã‚¤ãƒ«é€ä¿¡
```

### 2. ãƒ‡ã‚¤ãƒªãƒ¼ãƒ–ãƒªãƒ¼ãƒ•ã‚£ãƒ³ã‚°ãƒ•ãƒ­ãƒ¼

```
æ¯æœ8æ™‚ï¼ˆcronï¼‰
  â†“
Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ API
  â”œâ”€ ä»Šæ—¥ã®ã‚¤ãƒ™ãƒ³ãƒˆå–å¾—
  â†“
Notion API
  â”œâ”€ ä»Šæ—¥ã®ã‚¿ã‚¹ã‚¯å–å¾—
  â”œâ”€ æ˜¨æ—¥ã®ç©ã¿æ®‹ã—å–å¾—
  â†“
GitHub API
  â”œâ”€ æœªèª­PR/Issueå–å¾—
  â†“
Slackã«ãƒ–ãƒªãƒ¼ãƒ•ã‚£ãƒ³ã‚°æŠ•ç¨¿
  â”œâ”€ ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼äºˆå®š
  â”œâ”€ ã‚¿ã‚¹ã‚¯ä¸€è¦§
  â”œâ”€ ç©ã¿æ®‹ã—
  â””â”€ é€šçŸ¥
  â†“
Notionã«å±¥æ­´ä¿å­˜
```

### 3. çµŒè²»è¨˜éŒ²ãƒ•ãƒ­ãƒ¼

```
ãƒ¦ãƒ¼ã‚¶ãƒ¼: ãƒ¬ã‚·ãƒ¼ãƒˆç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
  â†“
Slack file_shared ã‚¤ãƒ™ãƒ³ãƒˆ
  â†“
ç”»åƒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
  â†“
Claude APIï¼ˆOCR + æƒ…å ±æŠ½å‡ºï¼‰
  â”œâ”€ åº—èˆ—å
  â”œâ”€ æ—¥ä»˜
  â”œâ”€ é‡‘é¡
  â”œâ”€ ã‚«ãƒ†ã‚´ãƒª
  â””â”€ å“ç›®
  â†“
NotionçµŒè²»DBä¿å­˜
  â†“
Slacké€šçŸ¥ï¼ˆç¢ºèªãƒ»ä¿®æ­£ãƒœã‚¿ãƒ³ä»˜ãï¼‰
```

---

## Notionçµ±åˆ

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ

#### 1. ã‚¿ã‚¹ã‚¯ç®¡ç†DB

| ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ | ã‚¿ã‚¤ãƒ— | èª¬æ˜ |
|-----------|--------|------|
| ã‚¿ã‚¹ã‚¯å | Title | ã‚¿ã‚¹ã‚¯ã®åå‰ |
| ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | Status | æœªç€æ‰‹/é€²è¡Œä¸­/å®Œäº†/ä¿ç•™ |
| å„ªå…ˆåº¦ | Select | é«˜/ä¸­/ä½ |
| æœŸé™ | Date | æœŸé™æ—¥æ™‚ |
| ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ | Select | æ‰€å±ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ |
| ã‚½ãƒ¼ã‚¹ | Select | Slack/ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼/æ‰‹å‹• |
| ä½œæˆæ—¥æ™‚ | Created time | è‡ªå‹• |
| Slack Thread | URL | Slackã‚¹ãƒ¬ãƒƒãƒ‰ãƒªãƒ³ã‚¯ |

#### 2. ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆDB

| ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ | ã‚¿ã‚¤ãƒ— | èª¬æ˜ |
|-----------|--------|------|
| ã‚¤ãƒ™ãƒ³ãƒˆå | Title | ã‚¤ãƒ™ãƒ³ãƒˆå |
| é–‹å§‹æ—¥æ™‚ | Date | é–‹å§‹ |
| çµ‚äº†æ—¥æ™‚ | Date | çµ‚äº† |
| å ´æ‰€ | Text | å ´æ‰€ãƒ»URL |
| å‚åŠ è€… | Multi-select | å‚åŠ è€…ãƒªã‚¹ãƒˆ |
| Google Calendar ID | Text | å…ƒã®ã‚¤ãƒ™ãƒ³ãƒˆID |
| åŒæœŸæ—¥æ™‚ | Last edited time | æœ€çµ‚åŒæœŸ |

#### 3. çµŒè²»ç®¡ç†DB

| ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ | ã‚¿ã‚¤ãƒ— | èª¬æ˜ |
|-----------|--------|------|
| åº—èˆ—å | Title | åº—èˆ—ãƒ»ã‚µãƒ¼ãƒ“ã‚¹å |
| é‡‘é¡ | Number | é‡‘é¡ï¼ˆå††ï¼‰ |
| æ—¥ä»˜ | Date | æ”¯æ‰•ã„æ—¥ |
| ã‚«ãƒ†ã‚´ãƒª | Select | äº¤é€šè²»/é£Ÿè²»/é€šä¿¡è²»/æ›¸ç±/ãã®ä»– |
| å“ç›® | Text | è©³ç´°å“ç›® |
| ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | Select | æœªç¢ºå®š/ç¢ºå®š/çµŒè²»ç”³è«‹æ¸ˆã¿ |
| ãƒ¬ã‚·ãƒ¼ãƒˆç”»åƒ | Files | ãƒ¬ã‚·ãƒ¼ãƒˆç”»åƒ |
| Slack Thread | URL | Slackã‚¹ãƒ¬ãƒƒãƒ‰ãƒªãƒ³ã‚¯ |

#### 4. ãƒ‡ã‚¤ãƒªãƒ¼ãƒ–ãƒªãƒ¼ãƒ•ã‚£ãƒ³ã‚°DB

| ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ | ã‚¿ã‚¤ãƒ— | èª¬æ˜ |
|-----------|--------|------|
| æ—¥ä»˜ | Title | YYYY-MM-DD |
| ã‚¤ãƒ™ãƒ³ãƒˆæ•° | Number | ãã®æ—¥ã®äºˆå®šæ•° |
| ã‚¿ã‚¹ã‚¯æ•° | Number | ã‚¿ã‚¹ã‚¯æ•° |
| é€šçŸ¥æ•° | Number | æœªèª­é€šçŸ¥æ•° |
| ãƒ–ãƒªãƒ¼ãƒ•ã‚£ãƒ³ã‚°å†…å®¹ | Text | å…¨æ–‡ |
| Slack Message | URL | Slackãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒªãƒ³ã‚¯ |

### Notionãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ä¾‹

```
ã€ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã€‘

ğŸ“Š ä»Šé€±ã®ã‚µãƒãƒªãƒ¼
â”œâ”€ ä½œæ¥­æ™‚é–“: 35æ™‚é–“
â”œâ”€ ã‚³ãƒŸãƒƒãƒˆæ•°: 42
â”œâ”€ å­¦ç¿’æ™‚é–“: 5æ™‚é–“
â”œâ”€ ãƒ–ãƒ­ã‚°è¨˜äº‹: 2æœ¬
â””â”€ çµŒè²»åˆè¨ˆ: Â¥12,450

ğŸ“ ä»Šæ—¥ã®ã‚¿ã‚¹ã‚¯
â”œâ”€ [é«˜] ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆMTGè³‡æ–™ä½œæˆ
â”œâ”€ [ä¸­] ãƒ–ãƒ­ã‚°è¨˜äº‹åŸ·ç­†
â””â”€ [ä½] æŠ€è¡“èª¿æŸ»ï¼ˆAstroï¼‰

ğŸ“… ä»Šé€±ã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼
â”œâ”€ æœˆ: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆMTG 14:00-15:00
â”œâ”€ ç«: ãƒãƒ¼ãƒ å®šä¾‹ 10:00-11:00
â””â”€ é‡‘: ãµã‚Šã‹ãˆã‚Š 17:00-18:00

ğŸ’° ä»Šæœˆã®çµŒè²»ï¼ˆÂ¥12,450ï¼‰
â”œâ”€ äº¤é€šè²»: Â¥3,200
â”œâ”€ æ›¸ç±: Â¥4,500
â”œâ”€ é€šä¿¡è²»: Â¥3,750
â””â”€ ãã®ä»–: Â¥1,000
```

---

## å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹çµ±åˆ

### 1. LINEçµ±åˆ

**ç”¨é€”**: LINEãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’Slackã«è»¢é€

```javascript
// LINE Webhook
app.post('/webhook/line', async (req, res) => {
  const events = req.body.events;

  for (const event of events) {
    if (event.type === 'message') {
      await app.client.chat.postMessage({
        channel: process.env.SLACK_LINE_CHANNEL,
        text: `ğŸ“± LINE: ${event.message.text}`
      });
    }
  }

  res.sendStatus(200);
});
```

**å¿…è¦ãªè¨­å®š**:
- LINE Developers ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ
- Messaging API Channelä½œæˆ
- Webhook URLè¨­å®š

### 2. Gmailçµ±åˆ

**ç”¨é€”**: é‡è¦ãƒ¡ãƒ¼ãƒ«ã‚’Slackã«é€šçŸ¥

```javascript
// 5åˆ†ã”ã¨ã«ãƒã‚§ãƒƒã‚¯
cron.schedule('*/5 * * * *', async () => {
  const emails = await checkImportantEmails();

  for (const email of emails) {
    await app.client.chat.postMessage({
      channel: process.env.SLACK_EMAIL_CHANNEL,
      blocks: [
        {
          type: 'section',
          text: {
            type: 'mrkdwn',
            text: `ğŸ“§ *${email.subject}*\nå·®å‡ºäºº: ${email.from}`
          }
        },
        {
          type: 'actions',
          elements: [{
            type: 'button',
            text: { type: 'plain_text', text: 'Gmailã§é–‹ã' },
            url: email.link
          }]
        }
      ]
    });
  }
});
```

**å¿…è¦ãªè¨­å®š**:
- Google Cloud Console ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ
- Gmail APIæœ‰åŠ¹åŒ–
- OAuthèªè¨¼

### 3. GitHubçµ±åˆ

**ç”¨é€”**: PRã€Issueé€šçŸ¥ã‚’Slackã«é›†ç´„

```javascript
// GitHub Webhook
app.post('/webhook/github', async (req, res) => {
  const event = req.headers['x-github-event'];
  const payload = req.body;

  if (event === 'pull_request' && payload.action === 'review_requested') {
    await app.client.chat.postMessage({
      channel: process.env.SLACK_GITHUB_CHANNEL,
      text: `ğŸ‘€ ãƒ¬ãƒ“ãƒ¥ãƒ¼ä¾é ¼: ${payload.pull_request.title}`
    });
  }

  res.sendStatus(200);
});
```

**å¿…è¦ãªè¨­å®š**:
- GitHub Repository Settings
- Webhook URLè¨­å®š
- Secretè¨­å®š

---

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …

### 1. èªè¨¼ãƒ»èªå¯

```javascript
// ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¨©é™ãƒã‚§ãƒƒã‚¯
const ALLOWED_USERS = ['U123456']; // ã‚ãªãŸã®Slack User ID

app.command('/slide', async ({ command, ack }) => {
  if (!ALLOWED_USERS.includes(command.user_id)) {
    await ack('âŒ ã“ã®ãƒœãƒƒãƒˆã¯è¨±å¯ã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ä½¿ç”¨ã§ãã¾ã™');
    return;
  }
  // å‡¦ç†ç¶šè¡Œ
});
```

### 2. ç’°å¢ƒå¤‰æ•°ç®¡ç†

```bash
# .env ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆGitã«ã‚³ãƒŸãƒƒãƒˆã—ãªã„ï¼‰
SLACK_BOT_TOKEN=xoxb-...
SLACK_APP_TOKEN=xapp-...
NOTION_API_KEY=secret_...
ANTHROPIC_API_KEY=sk-ant-...

# .gitignoreã«è¿½åŠ 
.env
.env.local
```

### 3. APIã‚­ãƒ¼ã®ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³

- å®šæœŸçš„ã«ã‚­ãƒ¼ã‚’å†ç™ºè¡Œ
- å¤ã„ã‚­ãƒ¼ã¯å³åº§ã«ç„¡åŠ¹åŒ–
- ã‚­ãƒ¼ã”ã¨ã«ã‚¹ã‚³ãƒ¼ãƒ—ã‚’æœ€å°é™ã«

### 4. ãƒ¬ãƒ¼ãƒˆåˆ¶é™

```javascript
// ä½¿ç”¨é‡åˆ¶é™
const DAILY_LIMIT = 10;

const usage = await supabase
  .from('api_usage')
  .select('count')
  .eq('user_id', userId)
  .gte('created_at', startOfDay);

if (usage.count >= DAILY_LIMIT) {
  await ack('âŒ æœ¬æ—¥ã®åˆ©ç”¨ä¸Šé™ã«é”ã—ã¾ã—ãŸ');
  return;
}
```

### 5. ãƒ‡ãƒ¼ã‚¿æš—å·åŒ–

- Notion APIã‚­ãƒ¼ã¯æš—å·åŒ–
- ãƒ¬ã‚·ãƒ¼ãƒˆç”»åƒã¯æœŸé™ä»˜ãURL
- æ©Ÿå¯†æƒ…å ±ã¯ãƒ­ã‚°ã«å‡ºåŠ›ã—ãªã„

---

## é‹ç”¨è¨ˆç”»

### èµ·å‹•æ–¹æ³•

```bash
# é–‹ç™ºç’°å¢ƒ
npm run dev

# æœ¬ç•ªç’°å¢ƒ
npm start

# ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰èµ·å‹•ï¼ˆPM2ï¼‰
pm2 start index.js --name mugu-slack
pm2 save
pm2 startup
```

### ç›£è¦–

```javascript
// ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
app.command('/health', async ({ ack, respond }) => {
  await ack();

  const health = {
    slack: 'âœ… æ¥ç¶šä¸­',
    notion: await checkNotionConnection() ? 'âœ…' : 'âŒ',
    googleCalendar: await checkGoogleConnection() ? 'âœ…' : 'âŒ',
    uptime: process.uptime()
  };

  await respond(JSON.stringify(health, null, 2));
});
```

### ãƒ­ã‚°ç®¡ç†

```javascript
const winston = require('winston');

const logger = winston.createLogger({
  level: 'info',
  format: winston.format.json(),
  transports: [
    new winston.transports.File({ filename: 'error.log', level: 'error' }),
    new winston.transports.File({ filename: 'combined.log' })
  ]
});

// ä½¿ç”¨ä¾‹
logger.info('Slide generated', { user: userId, skill: 'slide' });
logger.error('Failed to save to Notion', { error: err.message });
```

### ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—

- Notionãƒ‡ãƒ¼ã‚¿ã¯è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼ˆNotionå´ï¼‰
- Supabaseãƒ‡ãƒ¼ã‚¿ã¯æ—¥æ¬¡ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¯Gitã§ç®¡ç†

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œ

#### 1. Socket Modeæ¥ç¶šã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**: `Error: Invalid App token`

**è§£æ±ºç­–**:
- App-Level Tokenã‚’å†ç¢ºèª
- `xapp-` ã§å§‹ã¾ã‚‹ãƒˆãƒ¼ã‚¯ãƒ³ã‹ç¢ºèª
- Socket ModeãŒæœ‰åŠ¹åŒ–ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

#### 2. Notion API ã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**: `APIResponseError: Invalid database_id`

**è§£æ±ºç­–**:
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹IDã‚’å†ç¢ºèª
- IntegrationãŒDBã«æ¥ç¶šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- Shareè¨­å®šã§Integrationã‚’è¿½åŠ 

#### 3. Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼èªè¨¼ã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**: `invalid_grant`

**è§£æ±ºç­–**:
- Refresh Tokenã‚’å†å–å¾—
- OAuth Consentã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚’ç¢ºèª
- ã‚¹ã‚³ãƒ¼ãƒ—ãŒæ­£ã—ã„ã‹ç¢ºèª

---

## æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

å®Ÿè£…é–‹å§‹æ™‚ã®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆï¼š

- [ ] Slack Appã®ä½œæˆã¨Socket Modeæœ‰åŠ¹åŒ–
- [ ] å¿…è¦ãªAPIã‚­ãƒ¼ã®å–å¾—ï¼ˆNotionã€Googleã€LINEï¼‰
- [ ] Notionãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ä½œæˆ
- [ ] Node.jsãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
- [ ] ç’°å¢ƒå¤‰æ•°ã®è¨­å®š
- [ ] Phase 1ï¼ˆåŸºç›¤æ§‹ç¯‰ï¼‰ã‹ã‚‰é †æ¬¡å®Ÿè£…

---

**æ›´æ–°å±¥æ­´**:
- 2026-01-27: åˆç‰ˆä½œæˆ
