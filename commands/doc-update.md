# /doc-update - ドキュメント更新コマンド

**説明**: コード変更に応じてドキュメントを自動的に更新し、コードとドキュメントの一貫性を維持します。

## 使用方法

```
/doc-update [ドキュメントファイル（省略可）]
```

## 概要

`/doc-update` コマンドは、Doc Updaterエージェントを呼び出し、コード変更に応じてドキュメントを自動更新します。README.md、SKILL.md、エージェントドキュメント、コマンドドキュメントなどを最新の状態に保ちます。

## いつ使うか

- **新機能追加時**: 新しいエージェント、コマンド、スキルの追加
- **機能変更時**: 既存機能の仕様変更、パラメータの変更
- **機能削除時**: 非推奨機能の削除、APIの廃止
- **定期的なメンテナンス**: ドキュメントの整合性チェック、リンク切れの修正

## 使用例

### 例1: 新しいエージェント追加時のドキュメント更新

```
/doc-update
```

**入力**:
```
新しいエージェント「security-reviewer」を追加しました。
以下のドキュメントを更新してください:
- README.md: エージェント一覧に追加
- docs/roadmap.md: フェーズ2の進捗を更新
```

**出力**:
```markdown
# ドキュメント更新レポート

## 更新サマリー
- 更新日時: 2026-01-26 15:00
- トリガー: security-reviewerエージェントの追加
- 更新ドキュメント数: 2件

## 更新されたドキュメント

### 1. README.md
- **セクション**: エージェント
- **更新内容**: security-reviewerエージェントの説明を追加
  ```markdown
  ### security-reviewer
  セキュリティ脆弱性を検出し、OWASP Top 10に基づいてレビュー

  **使用方法**:
  ```
  /security-review [ファイルパス]
  ```

  **詳細**: [agents/security-reviewer.md](agents/security-reviewer.md)
  ```
- **理由**: 新しいエージェントが追加されたため

### 2. docs/roadmap.md
- **セクション**: フェーズ2: コア機能の追加
- **更新内容**: security-reviewerエージェントを完了としてマーク
  ```markdown
  - ✅ **security-reviewer** - セキュリティチェック
  ```
- **理由**: 実装が完了したため

## 整合性チェック結果
- ✅ 全てのリンクが有効
- ✅ フォーマットが統一されている
- ✅ 用語の一貫性が保たれている
```

### 例2: 複数のドキュメントを一括更新

```
/doc-update README.md docs/roadmap.md
```

**出力**:
```markdown
# ドキュメント更新レポート

## 更新サマリー
- 更新日時: 2026-01-26 16:00
- トリガー: フェーズ2完了に伴う一括更新
- 更新ドキュメント数: 2件

## 更新されたドキュメント

### 1. README.md
- **セクション**: バージョン履歴
- **更新内容**: v0.3.0を追加
  ```markdown
  ## バージョン履歴

  - **v0.3.0** (2026-01-26) - フェーズ2完了: エージェント追加
    - planner エージェント
    - code-reviewer エージェント
    - security-reviewer エージェント
    - doc-updater エージェント
    - /plan コマンド
    - /code-review コマンド
    - /security-review コマンド
  - **v0.2.0** (2026-01-26) - フェーズ1完了: 基盤整備
  - **v0.1.0** (2026-01-25) - 初期セットアップ
  ```
- **理由**: フェーズ2が完了したため

### 2. docs/roadmap.md
- **セクション**: フェーズ2: コア機能の追加
- **更新内容**: 全ての項目を完了としてマーク
  ```markdown
  ## フェーズ2: コア機能の追加 ✅ 完了

  ### エージェント
  - ✅ **planner** - 実装計画作成
  - ✅ **code-reviewer** - コード品質レビュー
  - ✅ **security-reviewer** - セキュリティチェック
  - ✅ **doc-updater** - ドキュメント同期

  ### コマンド
  - ✅ **/plan** - 計画作成モード
  - ✅ **/code-review** - コードレビュー実行
  - ✅ **/security-review** - セキュリティレビュー実行
  ```
- **理由**: 全ての項目の実装が完了したため
```

### 例3: 特定ドキュメントの整合性チェック

```
/doc-update --check README.md
```

**出力**:
```markdown
# ドキュメント整合性チェック結果

## README.md

### リンクチェック
- ✅ [agents/planner.md](agents/planner.md) - 有効
- ✅ [agents/code-reviewer.md](agents/code-reviewer.md) - 有効
- ✅ [agents/security-reviewer.md](agents/security-reviewer.md) - 有効
- ✅ [agents/doc-updater.md](agents/doc-updater.md) - 有効

### 用語の一貫性
- ✅ 「エージェント」の表記が統一されている
- ⚠️ 「コマンド」と「command」が混在（推奨: 「コマンド」に統一）

### コードサンプルの確認
- ✅ 全てのコードサンプルにシンタックスハイライト指定あり
- ✅ コマンド例が実際に動作する形式

### 推奨される更新
- 「command」を「コマンド」に統一（3箇所）
- バージョン履歴を最新化
```

## 更新対象ドキュメント

### 1. README.md
- プロジェクト概要
- インストール手順
- エージェント一覧
- コマンド一覧
- スキル一覧
- バージョン履歴

### 2. SKILL.md（各スキルディレクトリ）
- スキルの説明
- トリガー
- 使用例
- パラメータ

### 3. エージェントドキュメント（agents/*.md）
- 概要
- 使用タイミング
- プロセスフロー
- 使用例

### 4. コマンドドキュメント（commands/*.md）
- コマンドの説明
- オプション
- 使用例

### 5. ルールドキュメント（rules/*.md）
- コーディング規約
- セキュリティガイドライン
- テスト戦略

### 6. ロードマップ（docs/roadmap.md）
- フェーズ進捗
- チェックボックスの更新
- バージョン履歴

## ドキュメント更新プロセス

### ステップ1: 変更内容の分析
- コード変更の内容を特定
- 影響を受けるドキュメントを洗い出し
- 更新が必要な箇所を特定

### ステップ2: ドキュメントの読み込み
- 現在のドキュメントを読み込み
- 既存の構造を理解
- 更新箇所を特定

### ステップ3: ドキュメントの更新
- 新しい情報を追加
- 古い情報を削除
- 説明を明確化
- 例を更新

### ステップ4: 整合性チェック
- リンクの確認
- フォーマットの統一
- 用語の一貫性
- サンプルコードの動作確認

### ステップ5: レポート生成
- 更新内容のサマリー
- 変更箇所の詳細
- 推奨される追加更新

## オプション

- `--check`: 更新せずに整合性チェックのみ実行
- `--all`: 全てのドキュメントを対象に更新
- `--dry-run`: 実際の更新を行わず、変更内容のプレビューのみ

```
/doc-update --check README.md
/doc-update --all
/doc-update --dry-run
```

## ベストプラクティス

1. **コード変更と同時に更新**: プルリクエストにドキュメント更新を含める
2. **明確で簡潔な説明**: 専門用語は定義し、具体例を含める
3. **一貫性の維持**: 用語、フォーマット、スタイルを統一
4. **サンプルコードの動作確認**: 実際に動作するコードを記載
5. **バージョン管理**: 変更履歴を記録し、破壊的変更を明記

## ドキュメント品質チェックリスト

### コミット前
- [ ] 新機能がREADME.mdに記載されている
- [ ] バージョン履歴が更新されている
- [ ] 全てのリンクが有効
- [ ] サンプルコードが動作する

### Pull Request前
- [ ] 全てのドキュメントが更新されている
- [ ] 用語が一貫している
- [ ] フォーマットが統一されている
- [ ] 整合性チェックが完了

### マージ前
- [ ] ドキュメントレビューが完了
- [ ] 読者の視点で可読性を確認
- [ ] 他のドキュメントとの整合性を確認

## 関連エージェント

- **doc-updater**: このコマンドが呼び出すエージェント
- **planner**: 計画段階でドキュメント更新を含める
- **code-reviewer**: ドキュメント品質のレビュー
- **security-reviewer**: セキュリティドキュメントの更新

## モデル選択

ドキュメント更新には、効率的な作成のため**Haiku**または**Sonnet**モデルの使用を推奨します。

## 詳細情報

詳細は [agents/doc-updater.md](../agents/doc-updater.md) を参照してください。

## 注意事項

- ドキュメント更新は開発フローの一部
- コードとドキュメントは常に同期
- 読者（ユーザー）の視点を忘れない
- 完璧を求めすぎず、継続的に改善
- AI生成の内容は必ず人間が確認
