# /time-track - 時間追跡コマンド

**説明**: 業務委託の作業時間を記録・管理します。

## 使用方法

```
@timebot /in [プロジェクト名]   # 作業開始
@timebot /out                   # 作業終了
@timebot /status                # 状態確認
@timebot /invoice [YYYY-MM]     # 請求書生成（手動）
```

## 概要

`/time-track` コマンド群は、Time Trackerエージェントを呼び出し、Slackを通じて作業時間を記録します。データはSupabase（マスターDB）に保存され、Notion（閲覧用）にも同期されます。

## いつ使うか

- **作業開始時**: `/in プロジェクト名` で作業を開始
- **作業終了時**: `/out` で作業を終了し、経過時間を記録
- **状態確認時**: `/status` で現在の作業状態を確認
- **請求書が必要な時**: 月末に自動生成、または `/invoice` で手動生成

## コマンド詳細

### `/in [プロジェクト名]` - 作業開始

プロジェクトの作業を開始し、開始時刻を記録します。

**使用例**:
```
@timebot /in プロジェクトA
```

**応答**:
```
✅ 作業を開始しました
📁 プロジェクト: プロジェクトA
🕐 開始時刻: 09:30
```

**エラー時**:
```
❌ プロジェクト「XXX」が見つかりません
登録済みプロジェクト: プロジェクトA, プロジェクトB, 保守案件C
```

```
⚠️ 現在「プロジェクトA」で作業中です
先に /out で終了してください
```

### `/out` - 作業終了

現在の作業を終了し、経過時間を計算・記録します。

**使用例**:
```
@timebot /out
```

**応答**:
```
✅ 作業を終了しました
📁 プロジェクト: プロジェクトA
🕐 終了時刻: 12:00
⏱️ 今回の作業時間: 2時間30分
📊 本日の合計: 5時間15分
```

**エラー時**:
```
⚠️ 現在作業中ではありません
/in [プロジェクト名] で開始してください
```

### `/status` - 状態確認

現在の作業状態と今日の合計作業時間を確認します。

**使用例**:
```
@timebot /status
```

**応答（作業中）**:
```
🔵 作業中
📁 プロジェクト: プロジェクトA
🕐 開始時刻: 09:30
⏱️ 経過時間: 1時間45分
```

**応答（作業なし）**:
```
⚪ 作業していません
📊 本日の合計: 2時間45分
```

### `/invoice [YYYY-MM]` - 請求書生成（手動）

指定した月の請求書を手動で生成します。

**使用例**:
```
@timebot /invoice 2026-01
```

**応答**:
```
📄 2026年1月の請求書を生成しています...

✅ 請求書を生成しました
📄 株式会社A_請求書_2026年01月.xlsx
   💰 合計: ¥250,250（税込）
```

## 1日の使用フロー例

```
09:00  @timebot /in プロジェクトA
       → ✅ 作業を開始しました

12:00  @timebot /out
       → ✅ 作業を終了しました（3時間0分）
       → 📊 本日の合計: 3時間0分

13:00  @timebot /in プロジェクトB
       → ✅ 作業を開始しました

15:30  @timebot /status
       → 🔵 作業中（2時間30分経過）

18:00  @timebot /out
       → ✅ 作業を終了しました（5時間0分）
       → 📊 本日の合計: 8時間0分
```

## 自動機能

### 月末請求書自動生成

毎月末日の23:00に、Invoice Generatorサブエージェントが自動的に実行されます。

**自動通知**:
```
📅 本日は締め日です

【2026年1月の作業サマリー】

📁 プロジェクトA（株式会社A）
   ⏱️ 合計: 45時間30分
   💰 請求額: ¥227,500

📁 プロジェクトB（株式会社B）
   ⏱️ 合計: 20時間15分
   💰 請求額: ¥91,125

━━━━━━━━━━━━━━━━━━
💰 総合計: ¥318,625
━━━━━━━━━━━━━━━━━━

請求書を生成しています...
```

## データ保存先

| 保存先 | 用途 | 内容 |
|--------|------|------|
| **Supabase** | マスターDB | 全作業ログ、正確な集計 |
| **Notion** | 閲覧用 | カレンダービュー、手動修正 |
| **Slack** | 通知 | リアルタイム通知、ファイル共有 |

## 関連エージェント

- `agents/time-tracker.md` - Time Trackerエージェント
- `agents/invoice-generator.md` - Invoice Generatorサブエージェント

## 関連ファイル

- `skills/time-track/SKILL.md` - スキル登録
- `src/lib/supabase/time-tracker-schema.sql` - DBスキーマ
- `docs/time-tracker-spec.md` - 詳細仕様書
