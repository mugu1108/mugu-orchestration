# Daily Briefing Agent - デイリーブリーフィングエージェント

## 概要

Daily Briefingエージェントは、毎朝の情報をまとめてSlackに自動投稿する専門エージェントです。今日のタスク、カレンダー予定、昨日の積み残し、重要な通知などを一目で確認できるようにし、1日の準備を効率化します。

## 使用タイミング

以下の場合にDaily Briefingエージェントが動作します:

1. **自動実行（毎朝）**
   - 毎日8:00にSlackに自動投稿
   - 平日のみ / 毎日の設定が可能

2. **手動実行**
   - Slackコマンドで即座にブリーフィングを取得

## Slackコマンド

### 自動投稿（毎朝8:00）

設定された時刻に自動でブリーフィングを投稿します。

### `/briefing` - 手動でブリーフィング取得

```
@assistant /briefing
```

**応答例**:
```
☀️ おはようございます！1月28日（火）

━━━━━━━━━━━━━━━━━━━━━━━━

📅 今日の予定
• 10:00-11:00 | チーム定例MTG
• 14:00-15:00 | クライアントMTG（オンライン）
• 16:00-17:00 | 1on1

━━━━━━━━━━━━━━━━━━━━━━━━

✅ 今日のタスク
🔴 [高] クライアントMTG資料作成
🔴 [高] 請求書送付
🟡 [中] ブログ記事執筆
🟢 [低] 技術調査（Astro）

━━━━━━━━━━━━━━━━━━━━━━━━

⚠️ 昨日の積み残し (2件)
• コードレビュー対応
• ドキュメント更新

━━━━━━━━━━━━━━━━━━━━━━━━

🔔 未読通知
• GitHub PR: 3件のレビュー待ち
• GitHub Issues: 1件のメンション
• Slack DM: 2件

━━━━━━━━━━━━━━━━━━━━━━━━

🌤️ 東京: 晴れ（最高15℃/最低8℃）

━━━━━━━━━━━━━━━━━━━━━━━━

💡 今日も良い1日を！
```

## 情報ソース

### 1. カレンダー（Googleカレンダー）
- 今日の予定を時系列で表示
- MTGのタイトル、時間、場所/URL
- 終日イベントも対応

### 2. タスク（Notion）
- NotionのタスクDBから取得
- 期限が今日のタスク
- 優先度でソート（高→中→低）
- ステータスが「未完了」のもの

### 3. 積み残し（Notion）
- 期限が昨日以前で未完了のタスク
- 最大5件まで表示

### 4. GitHub通知
- 自分へのレビューリクエスト
- メンションされたIssue/PR
- 未読通知の件数

### 5. Slack通知
- 未読DM件数
- メンションされたメッセージ件数

### 6. 天気予報（Weather API）
- 設定した地域の天気
- 最高/最低気温
- 天気アイコン

## 設定オプション

### 環境変数

```bash
# ブリーフィング設定
BRIEFING_TIME=08:00              # 投稿時刻
BRIEFING_TIMEZONE=Asia/Tokyo     # タイムゾーン
BRIEFING_WEEKDAYS_ONLY=true      # 平日のみ投稿
BRIEFING_CHANNEL_ID=C...         # 投稿先チャンネル

# 連携サービス
GOOGLE_CALENDAR_ID=...           # GoogleカレンダーID
NOTION_TASKS_DB_ID=...           # NotionタスクDB ID
GITHUB_TOKEN=...                 # GitHub PAT
WEATHER_API_KEY=...              # Weather API Key
WEATHER_LOCATION=Tokyo           # 天気の地域
```

### カスタマイズ可能な項目

| 項目 | デフォルト | 説明 |
|------|-----------|------|
| 投稿時刻 | 08:00 | ブリーフィング投稿時刻 |
| 平日のみ | true | 土日はスキップ |
| タスク表示数 | 10件 | 表示する最大タスク数 |
| 積み残し表示数 | 5件 | 表示する最大積み残し数 |
| 天気表示 | true | 天気予報の表示 |

## データ構造

### Notion タスクDB（必要なプロパティ）

| プロパティ | 型 | 説明 |
|-----------|-----|------|
| タイトル | Title | タスク名 |
| 期限 | Date | 期限日 |
| 優先度 | Select | 高/中/低 |
| ステータス | Select | 未着手/進行中/完了 |

## 処理フロー

```
毎日 08:00（cron）
    ↓
1. 平日チェック（設定による）
    ↓
2. Googleカレンダーから今日の予定を取得
    ↓
3. Notionから今日のタスクを取得
    ↓
4. Notionから積み残しタスクを取得
    ↓
5. GitHub APIから通知を取得
    ↓
6. Weather APIから天気を取得
    ↓
7. メッセージを組み立て
    ↓
8. Slackに投稿
```

各情報ソースは独立して取得する。一部のソースが失敗しても、他のセクションは投稿する。取得失敗のセクションには `⚠️ [サービス名]の取得に失敗しました` を表示する。

## エラーハンドリング

### 一部のサービスが利用不可の場合

各セクションは独立して取得するため、一部が失敗しても他のセクションは表示されます。

```
☀️ おはようございます！1月28日（火）

📅 今日の予定
⚠️ カレンダーの取得に失敗しました

✅ 今日のタスク
🔴 [高] クライアントMTG資料作成
...

🌤️ 天気情報を取得できませんでした
```

### 全サービスが利用不可の場合

```
⚠️ ブリーフィングの生成に失敗しました

一部のサービスに接続できません。
設定を確認してください。
```

## 使用例

### 基本的な朝のフロー

```
08:00 [自動投稿]
      ☀️ おはようございます！1月28日（火）

      📅 今日の予定
      • 10:00 チーム定例MTG
      ...

08:05 ユーザーがSlackを確認
      → 今日の予定とタスクを把握
      → 優先度の高いタスクから着手
```

### 手動でブリーフィングを取得

```
User: @assistant /briefing
```
