---
name: doc-update
description: コード変更に応じてドキュメントを自動的に更新し、コードとドキュメントの一貫性を維持します
category: documentation
triggers:
  - "doc-update"
  - "ドキュメント更新"
  - "ドキュメント同期"
  - "documentation update"
  - "update docs"
tools:
  - Read
  - Edit
  - Write
  - Grep
  - Glob
  - Task
---

# /doc-update - ドキュメント更新コマンド

**説明**: コード変更に応じてドキュメントを自動的に更新し、コードとドキュメントの一貫性を維持します。

## 使用方法

```
/doc-update [ドキュメントファイル（省略可）]
```

## 概要

`/doc-update` コマンドは、Doc Updaterエージェントを呼び出し、コード変更に応じてドキュメントを自動更新します。README.md、SKILL.md、エージェントドキュメント、コマンドドキュメントなどを最新の状態に保ちます。

## 起動タイミング

- **新機能追加時**: 新しいエージェント、コマンド、スキルの追加
- **機能変更時**: 既存機能の仕様変更、パラメータの変更
- **機能削除時**: 非推奨機能の削除、APIの廃止
- **定期的なメンテナンス**: ドキュメントの整合性チェック、リンク切れの修正

## 前提条件

- プロジェクトのドキュメント構造が整っている
- マークダウンファイルが適切にフォーマットされている
- ドキュメントテンプレートが定義されている（agents/doc-updater.md参照）

## ワークフローステップ

### ステップ1: 変更内容の分析

コード変更の内容を分析し、影響を受けるドキュメントを特定します:

```typescript
// 新しいエージェントが追加された場合
- README.md: エージェント一覧に追加
- docs/roadmap.md: 進捗状況を更新
- agents/[agent-name].md: エージェント定義（既存）

// 新しいコマンドが追加された場合
- README.md: コマンド一覧に追加
- commands/[command-name].md: コマンド定義（既存）

// 新しいスキルが追加された場合
- README.md: スキル一覧に追加
- skills/[skill-name]/SKILL.md: スキル定義（既存）
```

### ステップ2: ドキュメントの読み込み

Readツールを使用して、更新対象のドキュメントを読み込みます:

```typescript
// 複数のドキュメントを並行して読み込み
Read("README.md")
Read("docs/roadmap.md")
Read("agents/planner.md")
```

### ステップ3: Doc Updaterエージェントの呼び出し

Taskツールを使用してdoc-updaterエージェントを起動します:

```
Task(
  subagent_type="general-purpose",
  description="Document update execution",
  prompt="agents/doc-updater.mdの指示に従って、以下の変更に基づいてドキュメントを更新してください: [変更内容]"
)
```

### ステップ4: ドキュメントの更新

Edit/Writeツールを使用して、ドキュメントを更新します:

```typescript
// README.mdにエージェントを追加
Edit({
  file_path: "README.md",
  old_string: "## エージェント\n\n### planner",
  new_string: "## エージェント\n\n### planner\n...\n\n### security-reviewer\nセキュリティ脆弱性を検出..."
})
```

### ステップ5: 整合性チェック

更新後のドキュメントの整合性をチェックします:

- **リンクチェック**: Grepで`[.*](.*)`パターンを検索し、リンク先の存在を確認
- **用語の一貫性**: 「エージェント」「コマンド」などの用語が統一されているか
- **フォーマット**: マークダウンのフォーマットが統一されているか

### ステップ6: レポート生成

更新内容をレポートとして出力します:

```markdown
# ドキュメント更新レポート

## 更新サマリー
- 更新日時: [日時]
- トリガー: [変更内容]
- 更新ドキュメント数: X件

## 更新されたドキュメント
[詳細]

## 整合性チェック結果
[チェック結果]
```

## 使用例

### 例1: 新しいエージェント追加時

```
ユーザー: /doc-update

説明: security-reviewerエージェントを追加したので、ドキュメントを更新してください

エージェント:
1. 変更内容を分析
   - 新エージェント: security-reviewer
   - 影響ドキュメント: README.md, docs/roadmap.md

2. ドキュメントを読み込み
   [README.mdとdocs/roadmap.mdを読み込み]

3. doc-updaterエージェントを呼び出し
   [エージェントが更新内容を生成]

4. ドキュメントを更新
   - README.md: エージェント一覧に追加
   - docs/roadmap.md: チェックボックスを更新

5. 整合性チェック
   ✅ リンクが有効
   ✅ フォーマットが統一

6. レポート生成
   [ドキュメント更新レポートを出力]
```

### 例2: バージョン履歴の更新

```
ユーザー: /doc-update README.md

説明: フェーズ2が完了したので、バージョン履歴を更新してください

エージェント:
[README.mdのバージョン履歴セクションを更新]

## バージョン履歴

- **v0.3.0** (2026-01-26) - フェーズ2完了: エージェント追加
  - planner エージェント
  - code-reviewer エージェント
  - security-reviewer エージェント
  - doc-updater エージェント
```

## 更新対象ドキュメント

### 1. README.md
- プロジェクト概要
- エージェント一覧
- コマンド一覧
- スキル一覧
- バージョン履歴

### 2. SKILL.md（各スキルディレクトリ）
- スキルの説明
- トリガー
- 使用例

### 3. エージェントドキュメント（agents/*.md）
- 概要
- 使用タイミング
- プロセスフロー

### 4. コマンドドキュメント（commands/*.md）
- コマンドの説明
- オプション
- 使用例

### 5. ロードマップ（docs/roadmap.md）
- フェーズ進捗
- チェックボックスの更新
- バージョン履歴

## mugu-orchestration固有の更新ルール

### エージェント追加時

```markdown
## エージェント

### [agent-name]
[説明]

**使用方法**:
```
/[command-name] [引数]
```

**詳細**: [agents/[agent-name].md](agents/[agent-name].md)
```

### バージョン履歴の形式

```markdown
## バージョン履歴

- **v0.X.0** (YYYY-MM-DD) - [フェーズ名]
  - [追加された機能1]
  - [追加された機能2]
```

### リンクの形式

- 内部リンク: 相対パス `[テキスト](agents/planner.md)`
- 外部リンク: 絶対URL `[テキスト](https://example.com)`

## ベストプラクティス

1. **コード変更と同時に更新**: プルリクエストにドキュメント更新を含める
2. **明確で簡潔な説明**: 専門用語は定義し、具体例を含める
3. **一貫性の維持**: 用語、フォーマット、スタイルを統一
4. **サンプルコードの動作確認**: 実際に動作するコードを記載
5. **バージョン管理**: 変更履歴を記録し、破壊的変更を明記

## 関連エージェント

- **doc-updater**: このコマンドが呼び出すエージェント
- **planner**: 計画段階でドキュメント更新を含める
- **code-reviewer**: ドキュメント品質のレビュー
- **security-reviewer**: セキュリティドキュメントの更新

## モデル選択

ドキュメント更新には、効率的な作成のため**Haiku**または**Sonnet**モデルの使用を推奨します。

## 詳細情報

詳細は [agents/doc-updater.md](../../agents/doc-updater.md) および [commands/doc-update.md](../../commands/doc-update.md) を参照してください。

## ドキュメント品質チェックリスト

### コミット前
- [ ] 新機能がREADME.mdに記載されている
- [ ] バージョン履歴が更新されている
- [ ] 全てのリンクが有効
- [ ] サンプルコードが動作する

### Pull Request前
- [ ] 全てのドキュメントが更新されている
- [ ] 用語が一貫している
- [ ] フォーマットが統一されている
- [ ] 整合性チェックが完了

## 注意事項

- ドキュメント更新は開発フローの一部
- コードとドキュメントは常に同期
- 読者（ユーザー）の視点を忘れない
- 完璧を求めすぎず、継続的に改善
- AI生成の内容は必ず人間が確認
